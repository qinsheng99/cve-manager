package dp

import (
	"errors"
	"regexp"
)

type cveNum string

var cveReg = regexp.MustCompile(`^CVE-\d+-\d+$`)

type CveNum interface {
	CveNum() string
}

func NewCVENum(v string) (CveNum, error) {
	if !cveReg.MatchString(v) {
		return nil, errors.New("invalid CVE num")
	}

	return cveNum(v), nil
}

func (c cveNum) CveNum() string {
	return string(c)
}
