package app

import (
	"github.com/opensourceways/cve-manager/cve/domain"
	"github.com/opensourceways/cve-manager/cve/domain/repository"
)

type CveBasicService interface {
	AddCveBasicInfo(app *CmdToAddCveBasicInfo) error
}

type cveBasicService struct {
	repo repository.CveBasic
}

func NewCveBasicService(repo repository.CveBasic) CveBasicService {
	return &cveBasicService{
		repo: repo,
	}
}

func (c *cveBasicService) AddCveBasicInfo(app *CmdToAddCveBasicInfo) error {
	info := domain.NewCveBasicInfo(app.Source, app.CveApplication, app.CveNum)

	err := c.repo.AddCveBasicInfo(&info)
	if err != nil {
		return err
	}

	// TODO send message  info.CVENum.CVENum

	return nil
}
